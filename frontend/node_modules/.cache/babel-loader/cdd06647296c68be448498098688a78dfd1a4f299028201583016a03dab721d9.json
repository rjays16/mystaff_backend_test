{"ast":null,"code":"import { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-1c56b8ac\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"i\", {\n  class: \"fas fa-cloud-upload-alt\"\n}, null, -1 /* HOISTED */));\nconst _hoisted_2 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"p\", null, \"Click to choose a video or drag and drop it here\", -1 /* HOISTED */));\nconst _hoisted_3 = {\n  key: 0\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_b_modal = _resolveComponent(\"b-modal\");\n  return _openBlock(), _createElementBlock(\"div\", null, [_createVNode(_component_b_modal, {\n    id: \"upload-video-modal\",\n    modelValue: $data.isModalVisible,\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $data.isModalVisible = $event),\n    title: \"Upload Video\",\n    \"ok-title\": \"Upload\",\n    \"ok-class\": \"btn-upload\",\n    onOk: $options.handleUpload\n  }, {\n    default: _withCtx(() => [_createElementVNode(\"div\", {\n      class: \"custom-file-upload\",\n      onClick: _cache[0] || (_cache[0] = (...args) => $options.triggerFileInput && $options.triggerFileInput(...args))\n    }, [_hoisted_1, _hoisted_2, $data.videoFile ? (_openBlock(), _createElementBlock(\"p\", _hoisted_3, \"Selected: \" + _toDisplayString($data.videoFile.name), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"input\", {\n      type: \"file\",\n      ref: \"fileInput\",\n      onChange: _cache[1] || (_cache[1] = (...args) => $options.onFileSelected && $options.onFileSelected(...args)),\n      accept: \"video/*\",\n      style: {\n        \"display\": \"none\"\n      }\n    }, null, 544 /* NEED_HYDRATION, NEED_PATCH */)]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"modelValue\", \"onOk\"])]);\n}","map":{"version":3,"names":["_createElementVNode","class","key","_createElementBlock","_createVNode","_component_b_modal","id","modelValue","$data","isModalVisible","_cache","$event","title","onOk","$options","handleUpload","default","_withCtx","onClick","args","triggerFileInput","_hoisted_1","_hoisted_2","videoFile","_hoisted_3","_toDisplayString","name","_createCommentVNode","type","ref","onChange","onFileSelected","accept","style","_"],"sources":["C:\\xampp\\htdocs\\assessment_test\\ui\\src\\components\\Modal\\UploadModal.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <b-modal id=\"upload-video-modal\" v-model=\"isModalVisible\" title=\"Upload Video\" ok-title=\"Upload\" ok-class=\"btn-upload\" @ok=\"handleUpload\">\r\n      <div class=\"custom-file-upload\" @click=\"triggerFileInput\">\r\n        <i class=\"fas fa-cloud-upload-alt\"></i>\r\n        <p>Click to choose a video or drag and drop it here</p>\r\n        <p v-if=\"videoFile\">Selected: {{ videoFile.name }}</p>\r\n      </div>\r\n      <input \r\n        type=\"file\" \r\n        ref=\"fileInput\" \r\n        @change=\"onFileSelected\" \r\n        accept=\"video/*\" \r\n        style=\"display: none;\"\r\n      >\r\n    </b-modal>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Swal from 'sweetalert2';\r\nimport { mapActions } from 'vuex';\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      videoFile: null,\r\n      isModalVisible: false,\r\n    };\r\n  },\r\n  methods: {\r\n    ...mapActions(['initiateVideoUpload', 'checkUploadStatus']),\r\n    showModal() {\r\n      this.isModalVisible = true;\r\n    },\r\n    triggerFileInput() {\r\n      this.$refs.fileInput.click();\r\n    },\r\n    onFileSelected(event) {\r\n      this.videoFile = event.target.files[0];\r\n    },\r\n    handleUpload() {\r\n      if (this.videoFile) {\r\n        const formData = new FormData();\r\n        formData.append('file', this.videoFile);\r\n\r\n        this.initiateVideoUpload(formData)\r\n          .then((video) => { \r\n            Swal.fire({\r\n              icon: 'info',\r\n              title: 'Upload Initiated',\r\n              text: 'Your video upload has started. You can check the status in the video list.',\r\n              confirmButtonText: 'OK',\r\n            });\r\n            this.resetForm();\r\n            this.$emit('video-upload-initiated', video.id);\r\n            this.pollUploadStatus(video.id);\r\n          })\r\n          .catch(error => {\r\n            Swal.fire({\r\n              icon: 'error',\r\n              title: 'Error',\r\n              text: error.response?.data?.message || 'An error occurred'\r\n            });\r\n          });\r\n      }\r\n    },\r\n    resetForm() {\r\n      this.videoFile = null;\r\n      this.isModalVisible = false;\r\n    },\r\n    pollUploadStatus(videoId) {\r\n  const checkStatus = () => {\r\n    this.checkUploadStatus(videoId)\r\n      .then(({ status, progress }) => {\r\n        if (status === 'completed') {\r\n          Swal.fire({\r\n            icon: 'success',\r\n            title: 'Upload Completed',\r\n            text: 'Your video has been successfully uploaded.',\r\n            confirmButtonText: 'OK',\r\n          });\r\n        } else if (status === 'failed') {\r\n          Swal.fire({\r\n            icon: 'error',\r\n            title: 'Upload Failed',\r\n            text: 'There was an error uploading your video.',\r\n            confirmButtonText: 'OK',\r\n          });\r\n        } else {\r\n          // Show progress\r\n          Swal.fire({\r\n            title: 'Uploading...',\r\n            html: `Upload progress: ${Math.round(progress)}%`,\r\n            allowOutsideClick: false,\r\n            showConfirmButton: false,\r\n            willOpen: () => {\r\n              Swal.showLoading();\r\n            }\r\n          });\r\n          // If still uploading, check again after 5 seconds\r\n          setTimeout(checkStatus, 5000);\r\n        }\r\n      })\r\n      .catch(error => {\r\n        console.error('Error checking upload status:', error);\r\n        Swal.fire({\r\n          icon: 'error',\r\n          title: 'Error',\r\n          text: 'Failed to check upload status.',\r\n          confirmButtonText: 'OK',\r\n        });\r\n      });\r\n  };\r\n\r\n  checkStatus();\r\n}\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n/* ... (styles remain the same) ... */\r\n</style>"],"mappings":";;gEAIQA,mBAAA,CAAuC;EAApCC,KAAK,EAAC;AAAyB;gEAClCD,mBAAA,CAAuD,WAApD,kDAAgD;;EAL3DE,GAAA;AAAA;;;uBACEC,mBAAA,CAeM,cAdJC,YAAA,CAaUC,kBAAA;IAbDC,EAAE,EAAC,oBAAoB;IAFpCC,UAAA,EAE8CC,KAAA,CAAAC,cAAc;IAF5D,uBAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAE8CH,KAAA,CAAAC,cAAc,GAAAE,MAAA;IAAEC,KAAK,EAAC,cAAc;IAAC,UAAQ,EAAC,QAAQ;IAAC,UAAQ,EAAC,YAAY;IAAEC,IAAE,EAAEC,QAAA,CAAAC;;IAFhIC,OAAA,EAAAC,QAAA,CAGM,MAIM,CAJNjB,mBAAA,CAIM;MAJDC,KAAK,EAAC,oBAAoB;MAAEiB,OAAK,EAAAR,MAAA,QAAAA,MAAA,UAAAS,IAAA,KAAEL,QAAA,CAAAM,gBAAA,IAAAN,QAAA,CAAAM,gBAAA,IAAAD,IAAA,CAAgB;QACtDE,UAAuC,EACvCC,UAAuD,EAC9Cd,KAAA,CAAAe,SAAS,I,cAAlBpB,mBAAA,CAAsD,KAN9DqB,UAAA,EAM4B,YAAU,GAAAC,gBAAA,CAAGjB,KAAA,CAAAe,SAAS,CAACG,IAAI,oBANvDC,mBAAA,e,GAQM3B,mBAAA,CAMC;MALC4B,IAAI,EAAC,MAAM;MACXC,GAAG,EAAC,WAAW;MACdC,QAAM,EAAApB,MAAA,QAAAA,MAAA,UAAAS,IAAA,KAAEL,QAAA,CAAAiB,cAAA,IAAAjB,QAAA,CAAAiB,cAAA,IAAAZ,IAAA,CAAc;MACvBa,MAAM,EAAC,SAAS;MAChBC,KAAsB,EAAtB;QAAA;MAAA;;IAbRC,CAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}